const mongoose = require("mongoose");

const url = `mongodb://${process.env.MONGODB_PORT || '127.0.0.1'}/malware`;

mongoose.connect(url);

const fileSchema = new mongoose.Schema({
    name: {type: String, required: true},
    type: String,
    size: Number,
    hashSHA256: {type: String, unique: true},
    hashMD5: String

});

const File = mongoose.model("File", fileSchema);

let file = {
    name: "Test",
    type: "test",
    size: 230,
    hashSHA256: "test1"
}

async function createFile(fileObject){
    try{
        const file  = await File.create(fileObject);
        await file.save();
        console.log("added malware to db");
    } catch (e){
        console.error(e);
    }
}

// createFile(file);

module.exports = {createFile}

// export async function updateUser(username, update){
//     try{
//         const user = await User.findOneAndUpdate({username: username}, update, {
//             new: true
//         });
        
//         await user.save();
//         return user;
//     }
//     catch (e){
//         console.log("Error:", e.message);
//     }
// }

// export async function findUser(username){
//     try{
//         const user = await User.where("username").equals(username);
        
//         return user[0];
//     }
//     catch (e){
//         console.log("Error:", e.message);
//     }
// }

// export async function searchUsers(){
//     try{
//         const users = await User.find({}, {username: 1, name: 1, tags: 1});
        
//         return users;
//     }
//     catch (e){
//         console.log("Error:", e.message);
//     }
// }

// export { createUser, updateUser, findUser, searchUsers };