import React from 'react';
import axios from 'axios';

function Form(props) {

    function handleSubmit(event) {
        event.preventDefault()
        
        const fileInput = event.target.querySelector('input[type="file"]');
        const file = fileInput.files[0];

        const url = 'http://localhost:3001/upload-file';

        const formData = new FormData();
        formData.append('file', file);
        formData.append('fileName', file.name);
        formData.append('fileType', file.type)

        const config = {
            headers: {
                'Content-Type': 'multipart/form-data',
            }
        };

        console.log(formData.get("fileName"));

        axios.post(url, formData, config)
            .then((response) => {
                console.log(response.data);
                props.onUpdate(
                    true, 
                    {
                        fileName: file.name,
                        size: file.size,
                        type: file.type,
                        lastModified: file.lastModified
                    },
                    {
                        hashSHA256: response.data.hashSHA256, 
                        hashMD5: ""
                    },
                    response.data.hashStatus,
                    response.data.graphLocation
                );
            })
            .catch((error) => {
                console.log(error.message);
            })

    }

    return (
        <form className='file-upload' onSubmit={ handleSubmit }>
            <input type="file" name='file' /> 
            <button type="submit">Upload</button>
        </form>
    );
}

export default Form;